import{j as e,L as T,a as m,r as s}from"./index-59d85926.js";import{P as y,F as j,a as D,g as E,L as x}from"./index.esm-9b6f1ce3.js";const F="pokedex-card",R=({pokemon:r})=>e("div",{id:F,children:e(T,{to:`/details/${r.id}`,children:e("div",{className:"card",children:e(y,{pokemon:r})})})}),C="pokedex-pagination",_=({handleBackPage:r,handleNextPage:l,page:k,totalPages:N})=>m("div",{className:"pagination-container",id:C,children:[e("button",{onClick:r,className:"pagination-button",id:`${C}-back`,children:e("div",{children:e(j,{size:30,color:"#373E59"})})}),m("div",{className:"pagination-page",children:[k," of ",N]}),e("button",{onClick:l,className:"pagination-button",id:`${C}-next`,children:e("div",{children:e(D,{size:30,color:"#373E59"})})})]}),z="pokedex-home",B=()=>{const[r,l]=s.useState(!0),[k,N]=s.useState(0),[c,u]=s.useState(0),[p,f]=s.useState([]),[i,L]=s.useState("pagination"),[h,b]=s.useState(!0),[d,g]=s.useState(!1),P=s.useRef(),a=20,v=async(t=!1)=>{try{const o=t?0:c,n=await E(a,a*o);t?(f((n==null?void 0:n.pokemons)||[]),u(0)):f(i==="infinite"?I=>[...I,...(n==null?void 0:n.pokemons)||[]]:(n==null?void 0:n.pokemons)||[]),N(Math.ceil((n==null?void 0:n.count)/a)),b((o+1)*a<(n==null?void 0:n.count)),setTimeout(()=>{l(!1),g(!1)},1500)}catch(o){throw console.log("fetchPokemons error:",o),l(!1),g(!1),new Error("üß™ Check connection")}},S=()=>{c>0&&u(c-1)},O=()=>{c+1!==k&&u(c+1)},M=s.useCallback(async()=>{if(d||!h)return;g(!0);const t=Math.floor(p.length/a);try{const o=await E(a,a*t);f(n=>[...n,...(o==null?void 0:o.pokemons)||[]]),b((t+1)*a<(o==null?void 0:o.count)),g(!1)}catch(o){throw console.log("loadMorePokemons error:",o),g(!1),new Error("üß™ Check connection")}},[p.length,h,d]),$=s.useCallback(t=>{r||i!=="infinite"||(P.current&&P.current.disconnect(),P.current=new IntersectionObserver(o=>{o[0].isIntersecting&&h&&!d&&M()}),t&&P.current.observe(t))},[r,h,d,M,i]),w=t=>{L(t),l(!0),g(!1),t==="pagination"?(u(0),v(!0)):(f([]),u(0),v(!0))};return s.useEffect(()=>{i==="pagination"&&(l(!0),v())},[c,i]),s.useEffect(()=>{v(!0)},[]),m("div",{id:z,children:[m("div",{className:"view-mode-toggle",children:[e("button",{className:`toggle-btn ${i==="pagination"?"active":""}`,onClick:()=>{i!=="pagination"&&w("pagination")},children:"Pagination"}),e("button",{className:`toggle-btn ${i==="infinite"?"active":""}`,onClick:()=>{i!=="infinite"&&w("infinite")},children:"Infinite Scroll"})]}),r?e(x,{}):m("div",{className:"container",children:[e("div",{className:"pokemon-list-container",children:(()=>p.map((t,o)=>{const n=o===p.length-1;return e("div",{ref:i==="infinite"&&n?$:null,children:e(R,{pokemon:t})},t.id||o)}))()}),i==="pagination"&&e(_,{page:c+1,totalPages:k,handleBackPage:S,handleNextPage:O}),i==="infinite"&&d&&e("div",{className:"loading-more",children:e(x,{})}),i==="infinite"&&!h&&!d&&e("div",{className:"end-message",children:e("p",{children:"You've seen all Pok√©mon!"})})]})]})};export{z as COMPONENT_ID,B as default};
